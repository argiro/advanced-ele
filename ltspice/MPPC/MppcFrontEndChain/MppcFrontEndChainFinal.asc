Version 4
SHEET 1 5028 2228
WIRE 2976 -512 2976 -544
WIRE 3440 -512 3440 -544
WIRE 2976 -480 2976 -512
WIRE 3440 -480 3440 -512
WIRE 2976 -336 2976 -400
WIRE 3120 -336 2976 -336
WIRE 3216 -336 3120 -336
WIRE 3296 -336 3216 -336
WIRE 3440 -336 3440 -400
WIRE 3504 -336 3440 -336
WIRE 3584 -336 3504 -336
WIRE 3680 -336 3584 -336
WIRE 3760 -336 3680 -336
WIRE 3920 -336 3856 -336
WIRE 4000 -336 3920 -336
WIRE 4128 -336 4064 -336
WIRE 4160 -336 4128 -336
WIRE 1344 -320 1280 -320
WIRE 1456 -320 1344 -320
WIRE 1568 -320 1456 -320
WIRE 1632 -320 1568 -320
WIRE 592 -304 528 -304
WIRE 656 -304 592 -304
WIRE 816 -304 736 -304
WIRE 896 -304 816 -304
WIRE 1056 -304 976 -304
WIRE 1120 -304 1056 -304
WIRE 1904 -304 1872 -304
WIRE 1952 -304 1904 -304
WIRE 2080 -304 1952 -304
WIRE 2416 -304 2336 -304
WIRE 2496 -304 2416 -304
WIRE 2576 -304 2496 -304
WIRE 2976 -304 2976 -336
WIRE 3440 -304 3440 -336
WIRE 1344 -288 1344 -320
WIRE 1568 -288 1568 -320
WIRE 3120 -288 3120 -336
WIRE 3216 -288 3216 -336
WIRE 3584 -288 3584 -336
WIRE 3680 -288 3680 -336
WIRE 3856 -288 3856 -336
WIRE 1952 -272 1952 -304
WIRE 2496 -272 2496 -304
WIRE 816 -240 816 -304
WIRE 1344 -192 1344 -224
WIRE 1568 -192 1568 -224
WIRE 2976 -192 2976 -224
WIRE 3120 -176 3120 -224
WIRE 3216 -176 3216 -224
WIRE 3216 -176 3120 -176
WIRE 3440 -176 3440 -224
WIRE 3584 -176 3584 -224
WIRE 3584 -176 3440 -176
WIRE 3680 -176 3680 -224
WIRE 3680 -176 3584 -176
WIRE 2208 -160 2208 -208
WIRE 2496 -160 2496 -208
WIRE 2496 -160 2208 -160
WIRE 2976 -160 2976 -192
WIRE 3440 -160 3440 -176
WIRE 3856 -160 3856 -208
WIRE 1952 -144 1952 -208
WIRE 2208 -144 2208 -160
WIRE 2208 -144 1952 -144
WIRE 3120 -144 3120 -176
WIRE 2208 -128 2208 -144
WIRE 1344 -64 1280 -64
WIRE 1456 -64 1344 -64
WIRE 1568 -64 1456 -64
WIRE 1632 -64 1568 -64
WIRE 1344 -32 1344 -64
WIRE 1568 -32 1568 -64
WIRE 1344 64 1344 32
WIRE 1568 64 1568 32
WIRE -496 352 -624 352
WIRE 3600 368 3600 336
WIRE 3648 368 3600 368
WIRE -624 400 -624 352
WIRE -496 400 -496 352
WIRE -288 400 -496 400
WIRE -48 400 -288 400
WIRE 192 400 -48 400
WIRE 784 416 656 416
WIRE 3600 432 3600 368
WIRE -496 448 -496 400
WIRE -48 448 -48 400
WIRE 1952 448 1952 416
WIRE 2000 448 1952 448
WIRE 2336 448 2288 448
WIRE 2464 448 2336 448
WIRE 2656 448 2544 448
WIRE -288 464 -288 400
WIRE 784 464 784 416
WIRE 2848 464 2848 432
WIRE 2896 464 2848 464
WIRE 1952 512 1952 448
WIRE 3600 512 3600 432
WIRE 3696 512 3600 512
WIRE 3840 512 3776 512
WIRE 192 528 192 400
WIRE 1344 528 1344 480
WIRE 2848 528 2848 464
WIRE -496 560 -496 528
WIRE -288 560 -288 528
WIRE -288 560 -496 560
WIRE -48 560 -48 512
WIRE -48 560 -128 560
WIRE 48 560 -48 560
WIRE 784 576 784 544
WIRE 1952 576 1952 512
WIRE -496 592 -496 560
WIRE -288 592 -288 560
WIRE -128 592 -128 560
WIRE 48 592 48 560
WIRE 1344 592 1344 528
WIRE 1472 592 1344 592
WIRE 1696 592 1536 592
WIRE 1920 592 1696 592
WIRE 2848 592 2848 528
WIRE 3600 592 3600 512
WIRE 784 608 784 576
WIRE 928 608 784 608
WIRE 2112 608 1984 608
WIRE 2320 608 2112 608
WIRE 2464 608 2320 608
WIRE 2656 608 2656 448
WIRE 2656 608 2544 608
WIRE 2816 608 2656 608
WIRE 1344 624 1344 592
WIRE 1920 624 1840 624
WIRE 3072 624 2880 624
WIRE 3152 624 3072 624
WIRE 3264 624 3152 624
WIRE 3568 624 3264 624
WIRE 3728 624 3648 624
WIRE 3840 624 3840 512
WIRE 3840 624 3728 624
WIRE 3888 624 3840 624
WIRE 3968 624 3888 624
WIRE 1696 640 1696 592
WIRE 2816 640 2752 640
WIRE 3568 656 3504 656
WIRE 3888 672 3888 624
WIRE 928 688 784 688
WIRE 656 704 656 416
WIRE 784 704 784 688
WIRE 784 704 656 704
WIRE 1952 704 1952 640
WIRE 2000 704 1952 704
WIRE 2112 704 2112 608
WIRE 3376 704 3328 704
WIRE 3504 704 3504 656
WIRE 3504 704 3376 704
WIRE 2848 720 2848 656
WIRE 2896 720 2848 720
WIRE 3504 720 3504 704
WIRE 3584 720 3584 688
WIRE 3616 720 3616 688
WIRE 3616 720 3584 720
WIRE -496 736 -496 672
WIRE -288 736 -288 656
WIRE -288 736 -496 736
WIRE -128 736 -128 672
WIRE -128 736 -288 736
WIRE 48 736 48 656
WIRE 48 736 -128 736
WIRE 192 736 192 592
WIRE 192 736 48 736
WIRE 784 736 784 704
WIRE 1952 736 1952 704
WIRE 2848 752 2848 720
WIRE 1344 768 1344 704
WIRE 1696 768 1696 720
WIRE 3600 768 3600 688
WIRE 3888 768 3888 736
WIRE 3888 768 3600 768
WIRE 3888 784 3888 768
WIRE -496 800 -496 736
WIRE 1952 800 1952 736
WIRE 2480 800 2432 800
WIRE 2624 800 2560 800
WIRE 2752 800 2752 640
WIRE 2752 800 2688 800
WIRE 2848 816 2848 752
WIRE 3504 816 3504 784
WIRE 3584 816 3584 720
WIRE 3584 816 3504 816
WIRE 3584 832 3584 816
WIRE 2432 848 2432 800
WIRE -496 864 -496 800
WIRE 1840 864 1840 624
WIRE 2112 864 2112 784
WIRE 2112 864 1840 864
WIRE 2752 896 2752 800
WIRE 2880 896 2752 896
WIRE 3072 896 3072 624
WIRE 3072 896 2944 896
WIRE 3888 896 3888 864
WIRE 2112 912 2112 864
WIRE 3696 992 3696 960
WIRE 3744 992 3696 992
WIRE 2752 1024 2752 896
WIRE 2880 1024 2752 1024
WIRE 3072 1024 3072 896
WIRE 3072 1024 2960 1024
WIRE 2112 1040 2112 992
WIRE 3696 1056 3696 992
WIRE 3696 1120 3696 1056
WIRE 3264 1136 3264 624
WIRE 3664 1136 3264 1136
WIRE 3888 1152 3728 1152
WIRE 3952 1152 3888 1152
WIRE 4000 1152 3952 1152
WIRE 4048 1152 4000 1152
WIRE 3664 1168 3600 1168
WIRE 4000 1200 4000 1152
WIRE 3696 1248 3696 1184
WIRE 3744 1248 3696 1248
WIRE 3696 1280 3696 1248
WIRE 4000 1296 4000 1264
WIRE 3696 1344 3696 1280
WIRE 3600 1392 3600 1168
WIRE 3888 1392 3888 1152
WIRE 3888 1392 3600 1392
FLAG -496 800 Isipm
FLAG 2320 608 Vpreamp
FLAG 1952 736 VCC
FLAG 1952 512 VSS
FLAG 2112 1040 0
FLAG 1056 -304 VCC
FLAG 592 -304 VSS
FLAG 816 -240 0
FLAG 1696 768 0
FLAG 3728 624 Vdisc
FLAG 3440 -160 0
FLAG 2000 768 0
FLAG 2000 512 0
FLAG 1344 768 0
FLAG 3648 432 0
FLAG 3600 432 3V3
FLAG 3504 -336 Vth
FLAG 3584 832 0
FLAG 2208 -128 0
FLAG 2416 -304 3V3
FLAG 1904 -304 VCC
FLAG 2848 752 VCC
FLAG 2848 528 VSS
FLAG 2896 784 0
FLAG 2896 528 0
FLAG 3376 704 Vth
FLAG 2336 448 Voffset
FLAG 3856 -160 0
FLAG 3920 -336 Vstep
FLAG 2432 848 0
FLAG 3152 624 Vshaper
FLAG 3952 1152 Vbuffer
FLAG 3696 1280 VCC
FLAG 3696 1056 VSS
FLAG 3744 1312 0
FLAG 3744 1056 0
FLAG 3888 896 0
FLAG 4000 1296 0
FLAG 4128 -336 Vinj
FLAG 784 736 0
FLAG -624 400 0
FLAG 784 576 Isipm2
FLAG 1344 -192 0
FLAG 1568 -192 0
FLAG 1456 -320 VCC
FLAG 1344 64 0
FLAG 1568 64 0
FLAG 1456 -64 VSS
FLAG 2976 -512 VCC
FLAG 3120 -144 0
FLAG 3440 -512 VCC
FLAG 2976 -192 VSS
FLAG 1344 528 Vinj
SYMBOL current -496 448 R0
WINDOW 3 -560 37 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PULSE(0 {Npe*Qin/2p} 100n 1p 1p 1p 1u 1)
SYMATTR InstName I1
SYMBOL res -512 576 R0
SYMATTR InstName R1
SYMATTR Value {Rq}
SYMBOL cap -304 464 R0
SYMATTR InstName C1
SYMATTR Value {mc(Cd,0.1)}
SYMBOL cap -304 592 R0
SYMATTR InstName C2
SYMATTR Value {mc(Cq,0.01)}
SYMBOL cap 176 528 R0
SYMATTR InstName C3
SYMATTR Value {Cg}
SYMBOL cap -64 448 R0
SYMATTR InstName C4
SYMATTR Value {(Ncells-1)*Cd}
SYMBOL res -144 576 R0
SYMATTR InstName R2
SYMATTR Value {Rq/(Ncells-1)}
SYMBOL cap 32 592 R0
SYMATTR InstName C5
SYMATTR Value {(Ncells-1)*Cq}
SYMBOL res 1680 624 R0
SYMATTR InstName R3
SYMATTR Value 49.5
SYMBOL res 2096 1008 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R4
SYMATTR Value 50
SYMBOL Opamps\\LT1226 1952 672 M180
SYMATTR InstName U1
SYMBOL res 2096 800 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R5
SYMATTR Value 5k
SYMBOL voltage 752 -304 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V3
SYMATTR Value 5V
SYMBOL voltage 992 -304 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V4
SYMATTR Value 5V
SYMBOL res 1328 608 R0
SYMATTR InstName R9
SYMATTR Value 50
SYMBOL cap 1536 576 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C9
SYMATTR Value 1µ
SYMBOL cap 1984 704 R0
SYMATTR InstName C10
SYMATTR Value 100n
SYMBOL cap 1984 448 R0
SYMATTR InstName C11
SYMATTR Value 100n
SYMBOL cap 3632 368 R0
SYMATTR InstName C15
SYMATTR Value 100n
SYMBOL res 3792 496 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 50k
SYMBOL PowerProducts\\LT1117-3.3 2208 -304 R0
SYMATTR InstName U4
SYMBOL cap 2480 -272 R0
SYMATTR InstName C8
SYMATTR Value 2.2µ
SYMBOL cap 1936 -272 R0
SYMATTR InstName C16
SYMATTR Value 1µ
SYMBOL cap 2880 720 R0
SYMATTR InstName C7
SYMATTR Value 100n
SYMBOL cap 2880 464 R0
SYMATTR InstName C12
SYMATTR Value 100n
SYMBOL res 2976 1008 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value {Rlow}
SYMBOL voltage 3856 -304 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V6
SYMATTR Value PULSE(100m 120m 100n 1p 1p 500n 1u 2)
SYMBOL res 2576 784 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 50
SYMBOL cap 2944 880 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C13
SYMATTR Value {Clow}
SYMBOL cap 2688 784 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C14
SYMATTR Value {Chigh}
SYMBOL res 2560 432 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 1k
SYMBOL res 2560 592 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 50
SYMBOL cap 3728 1248 R0
SYMATTR InstName C17
SYMATTR Value 100n
SYMBOL cap 3728 992 R0
SYMATTR InstName C18
SYMATTR Value 100n
SYMBOL cap 3872 672 R0
SYMATTR InstName C19
SYMATTR Value 0
SYMBOL res 3872 768 R0
SYMATTR InstName R12
SYMATTR Value 100
SYMBOL cap 3488 720 R0
SYMATTR InstName C20
SYMATTR Value 100n
SYMBOL cap 3984 1200 R0
SYMATTR InstName Cprobe
SYMATTR Value 20p
SYMBOL cap 4064 -352 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C21
SYMATTR Value 40p
SYMBOL current 784 464 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName I2
SYMATTR Value EXP(0 {Npe*Vov/Rq} 100n 1p 0 {Rq*Cd})
SYMBOL cap 1328 -288 R0
SYMATTR InstName C6
SYMATTR Value 1µ
SYMBOL cap 1552 -288 R0
SYMATTR InstName C22
SYMATTR Value 100n
SYMBOL cap 1328 -32 R0
SYMATTR InstName C23
SYMATTR Value 1µ
SYMBOL cap 1552 -32 R0
SYMATTR InstName C24
SYMATTR Value 100n
SYMBOL cap 3104 -288 R0
SYMATTR InstName C25
SYMATTR Value 1µ
SYMBOL cap 3200 -288 R0
SYMATTR InstName C26
SYMATTR Value 100n
SYMBOL cap 3664 -288 R0
SYMATTR InstName C27
SYMATTR Value 100n
SYMBOL cap 3568 -288 R0
SYMATTR InstName C28
SYMATTR Value 1µ
SYMBOL res 2960 -320 R0
SYMATTR InstName R6
SYMATTR Value 5k
SYMBOL res 2960 -496 R0
SYMATTR InstName R14
SYMATTR Value 5k
SYMBOL res 3424 -320 R0
SYMATTR InstName R15
SYMATTR Value 70
SYMBOL res 3424 -496 R0
SYMATTR InstName R16
SYMATTR Value 5k
SYMBOL AD8056 2848 688 M180
SYMATTR InstName U3
SYMBOL AD8561 3600 576 R0
SYMATTR InstName U5
SYMBOL AD8056 3696 1216 M180
SYMATTR InstName U6
SYMBOL res 912 592 R0
SYMATTR InstName R17
SYMATTR Value 1
TEXT -304 -216 Left 2 !.tran 0 800n 0 1n
TEXT 280 512 Left 2 !.param Rq=300k
TEXT 280 560 Left 2 !.param Cd=25f
TEXT 280 656 Left 2 !.param Cg=10p
TEXT -1064 576 Left 2 !;.param Qin 225f
TEXT 280 608 Left 2 !.param Cq 10f
TEXT -1056 616 Left 2 !.param Ncells 2668
TEXT -1056 656 Left 2 !.param Npe 1
TEXT -1056 696 Left 2 !.param Vov={mc(10,0.05)}
TEXT -192 1064 Left 2 ;M approx. 7e5 for Vov = 5 V (from datasheet)  =>  Qin = M x qe  => approx. 7e5  x 1.6e-19 = 112 fC
TEXT -192 1168 Left 2 ;Qin approx 112 fC  @ Vov = 5V  =>  Cd approx. Qin/Vov = 22.4 fF
TEXT 1576 824 Left 2 ;exactly compensate\ninput bias current
TEXT -192 1216 Left 2 ;Vbr = 55 V (from datasheet)
TEXT -192 1120 Left 2 ;M approx 1.4e6 for Vov = 10 V (from datasheet) => Qin approx 1.4e6 x 1.6e-19 = 225 fC
TEXT -312 -112 Left 2 !;.step param run 1 25 1
TEXT -192 968 Left 2 ;Device: S13360 (ID) + 1.3 mm x 1.3mm area +  25um pitch + Ceramic package + Silicon window => S13360-1325CS
TEXT -192 1016 Left 2 ;Ncells = 2668
TEXT -304 -8 Left 2 !.step param Npe list 1 2 3 4 5
TEXT -1056 536 Left 2 !.param Qin={Vov*Cd}
TEXT 3368 912 Left 2 !.include "AD8561.cir"
TEXT 1448 488 Left 2 ;optionally, suppress low-frequency\n50 Hz pick-up
TEXT -304 -152 Left 2 ;MonteCarlo analysis
TEXT -304 -256 Left 2 ;Main transient analysis
TEXT -304 -48 Left 2 ;Parametric sweeps
TEXT -192 1264 Left 2 ;Terminal capacitance = 60p (from datasheet)  => Cd = Cterminal/Ncells = 24.4f
TEXT 1840 928 Left 2 ;stable closed-loop\ngain (Av > 25)
TEXT 2424 1128 Left 2 !.param Clow 50p
TEXT 2424 1168 Left 2 !.param Rlow 1k
TEXT 2424 1208 Left 2 !.param Chigh 1u
TEXT 2424 1272 Left 2 !;.step param Clow list 10p 50p 100p 150p 200p 300p 500p
TEXT 2424 1320 Left 2 !;.step param Rlow list 100 300 500 800 1k 2k 5k
TEXT 2632 232 Left 3 ;2nd stage: non-inverting CR-RC\nshaper with adjustable DC offset
TEXT 1744 240 Left 3 ;1st stage: fast non-inverting PREAMP
TEXT 2512 904 Left 2 ;high-pass filter\n(derivator)
TEXT 2856 1112 Left 2 ;low-pass filter\n(integrator)
TEXT 4120 1152 Left 2 ;optionally, BUFFER the shaped signal\nto be sent to oscilloscope probe
TEXT 3888 512 Left 2 ;pull-up resistor
TEXT 4016 760 Left 2 ;optionally, STRETCH the DISC output\npulse using an RC filter on the the LATCH pin
TEXT 3512 232 Left 3 ;3rd stage: high-speed DISC
TEXT -416 232 Left 3 ;SiPM equivalent electrical model\nF. Corsi et al. NIMA 572 (2007) 416-418
TEXT 600 232 Left 3 ;simplified electrical model\n(exponential current pulse)
TEXT 3904 -56 Left 2 ;test-pulse injection circuit
TEXT -336 -368 Left 3 ;-- Simulation statements --
TEXT 864 -488 Left 3 ;Power section and power-rails filtering
TEXT 1936 -488 Left 3 ;Independent DISC 3.3 V power supply rail\n(actually a MAX882 5V/3.3V adjustable regulator)
TEXT 3216 -608 Left 3 ;External controls (DC offset, threshold and test-pulse)
TEXT 3032 -56 Left 2 ;DC offset 10k POT
TEXT 3440 -56 Left 2 ;DISC threshold 10k POT\n(10 ohm = 10 mV)
TEXT 3000 544 Left 2 !.include "AD8056.cir"
